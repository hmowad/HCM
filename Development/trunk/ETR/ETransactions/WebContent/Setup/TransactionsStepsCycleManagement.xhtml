<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
xmlns:h="http://java.sun.com/jsf/html" 
xmlns:ui="http://java.sun.com/jsf/facelets" 
xmlns:f="http://java.sun.com/jsf/core" 
xmlns:rich="http://richfaces.org/rich"  
xmlns:util="http://java.sun.com/jsf/composite/util" 
xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<h:outputStylesheet library="css" name="styles.css" />
	<h:outputStylesheet library="css" name="grid.css" />
	<h:outputScript name="utilities.js" library="javascript" target="head" />
	<h:outputScript target="head">
		function applySearch()
		{
			document.getElementById('transactionsStepsCycleManagementFormId:searchBtn').click();
		}
		
		function getBasicJobsName(contextPath) {
			openBasicJobsNamesMiniSearch(contextPath, 'handleBasicJobsNamesMiniSearchResult(ret)', 1, -1, 0);
		}
		
		function handleBasicJobsNamesMiniSearchResult(ret){
			if (ret != null) {
				document.getElementById('transactionsStepsCycleManagementFormId:selectedBasicJobNameIDHId').value = ret[0];
				document.getElementById('transactionsStepsCycleManagementFormId:selectedBasicJobNameNameHId').value = ret[1];
				document.getElementById('transactionsStepsCycleManagementFormId:addJobNameBtnId').click();
			}
		}
	 </h:outputScript>
</h:head>
<h:body styleClass="screenBg">
	<h:form id="transactionsStepsCycleManagementFormId" dir="#{msgs.dir}">
		<ui:decorate template="/Main/Template.xhtml">
			<table border="0" cellpadding="0" cellspacing="3" width="100%">
				<tr>
					<td class="screenTitle" style="padding-bottom: 3px; margin-top: 20px;" width="100%">
						<span>
							<h:outputText value="#{msgs.title_transactionsStepsCycleManagement}" />
						</span>
					</td>
				</tr>
				
				
				<tr>
					<td height="15" />
				</tr>
				
				<tr>
					<td width="100%">
							<table class="sectionContent" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<td width="100%">
										<rich:dataTable rowKeyVar="index" id="wfTransactionDataTableId" value="#{transactionsStepsCycleManagement.wfProcessDataList}" var="wfProcess" rows="#{transactionsStepsCycleManagement.rowsCount}" onrowclick="changeSelectedRowStyle(this);" onrowmouseover="changeRowOverStyle(this);" onrowmouseout="resetRowOverStyle(this);" rowClasses="gridRowOdd,gridRowEven" styleClass="gridMaster">
											<rich:column style="width:10%">
												<f:facet name="header">#{msgs.label_select}</f:facet>
												<h:commandButton value="#{msgs.fa_check_square}" action="#{transactionsStepsCycleManagement.showWfTransactionDetails(wfProcess)}" styleClass="btn_icon" title="#{label_select}">
													<f:ajax execute="@this" render="transactionsStepsCycleManagementFormId:detailsPanelId transactionsStepsCycleManagementFormId:saveBtn" onevent="function(e){if(e.status == 'complete') unMaskScreen();}" />
												</h:commandButton>
											</rich:column>
											<rich:column style="width:10%">
												<f:facet name="header">#{msgs.label_processType}</f:facet>
												<h:outputText value="#{wfProcess.arabicName}" />
											</rich:column>
											
											<rich:column>
												<f:facet name="header">#{msgs.label_processEnabled}</f:facet>
												<h:selectBooleanCheckbox value="#{wfProcess.enableFlagBoolean}" onchange="#{transactionsStepsCycleManagement.enableWfProcess(wfProcess)}" />
											</rich:column>
											
											<f:facet name="footer">
												<rich:dataScroller fastControls="hide" oncomplete="#{rich:component('reload')}.hide()" maxPages="5">
													<f:facet name="first">
														#{msgs.label_first}
	                                            	</f:facet>
													<f:facet name="last">
                                                		#{msgs.label_last}
                                            		</f:facet>
													<f:facet name="next">
	                                              		#{msgs.label_next}
	                                        	    </f:facet>
													<f:facet name="previous">
	                                                	#{msgs.label_previous}
	                                            	</f:facet>
												</rich:dataScroller>
											</f:facet>
										</rich:dataTable>
									</td>
								</tr>
							</table>
					</td>
				</tr>
				<tr>
					<td>
						<h:panelGroup id="detailsPanelId">
							<h:panelGroup rendered="#{transactionsStepsCycleManagement.showWfProcessDetails}">
								<table class="sectionTitle" border="0" cellpadding="0" cellspacing="0" style="margin-top: 3px">
									<tr>
										<td width="100%">#{msgs.label_processSteps}</td>
									</tr>
								</table>
								
								<table border="0" cellpadding="0" cellspacing="0" style="margin-top: 3px">
									<tr>
										<td width="100%">
											<h:commandButton value="#{msgs.label_addProcessCycleStep} &#xf067;"  onclick="getBasicJobsName('#{request.contextPath}');return false;"  styleClass="btn_normal btn_float" style="float: right;" />
											<h:commandButton id="addJobNameBtnId" style="display: none;" action="#{transactionsStepsCycleManagement.getSelectedWFProcessData()}">
												<f:ajax execute="transactionsStepsCycleManagementFormId:selectedBasicJobNameIDHId transactionsStepsCycleManagementFormId:selectedBasicJobNameNameHId" render="transactionsStepsCycleManagementFormId:detailsDataTableId transactionsStepsCycleManagementFormId:notifyMessagesId"
													onevent="function(e){if(e.status == 'complete') unMaskScreen();}" />
											</h:commandButton>
											<h:inputHidden id="selectedBasicJobNameIDHId" value="#{transactionsStepsCycleManagement.selectedBasicJopNameId}" />
											<h:inputHidden id="selectedBasicJobNameNameHId" value="#{transactionsStepsCycleManagement.selectedBasicJopNameName}" />
										</td>
									</tr>
								</table>
								
								<rich:dataTable rowKeyVar="index" id="detailsDataTableId" value="#{transactionsStepsCycleManagement.wfProcessStepDataListToBeDisplayed}" var="wfProcessStep" rows="#{transactionsStepsCycleManagement.rowsCount}" onrowclick="changeSelectedRowStyle(this);" onrowmouseover="changeRowOverStyle(this);" onrowmouseout="resetRowOverStyle(this);" rowClasses="gridRowOdd,gridRowEven" styleClass="gridMaster">
									<rich:column style="width:15%">
										<f:facet name="header">#</f:facet>
										<h:outputText value="#{index + 1}" />
									</rich:column>
									
									<rich:column style="width:40%">
										<f:facet name="header">#{msgs.label_basicJobName}</f:facet>
										<h:outputText value="#{wfProcessStep.participantsNames}" />
									</rich:column>
									
									<rich:column style="width:15%">
										<f:facet name="header">#{msgs.label_approve}</f:facet>
										<h:selectBooleanCheckbox value="#{wfProcessStep.approve}" disabled="true"></h:selectBooleanCheckbox>
									</rich:column>
									
									<rich:column style="width:15%">
										<f:facet name="header">#{msgs.label_reject}</f:facet>
										<h:selectBooleanCheckbox value="#{wfProcessStep.reject}" disabled="true"></h:selectBooleanCheckbox>
									</rich:column>
									
									<rich:column style="width : 15%;" >
										<f:facet name="header">#{msgs.label_delete}</f:facet>
										<h:commandButton value="#{msgs.fa_times}" title="#{msgs.label_delete}" styleClass="btn_icon" onclick="return confirm('#{msgs.q_delete}');" action="#{transactionsStepsCycleManagement.deleteWfProcessStep(wfProcessStep)}">
											<f:ajax render="transactionsStepsCycleManagementFormId:detailsDataTableId" onevent="function(e){if(e.status == 'complete') unMaskScreen();}" />
										</h:commandButton>
									</rich:column>
								
									<f:facet name="footer">
										<rich:dataScroller fastControls="hide" oncomplete="#{rich:component('reload')}.hide()" maxPages="5">
											<f:facet name="first">
												#{msgs.label_first}
                                           	</f:facet>
											<f:facet name="last">
                                              		#{msgs.label_last}
                                          		</f:facet>
											<f:facet name="next">
                                             		#{msgs.label_next}
                                       	    </f:facet>
											<f:facet name="previous">
                                               	#{msgs.label_previous}
                                           	</f:facet>
										</rich:dataScroller>
									</f:facet>
								</rich:dataTable>
								<table class="actionsSection" border="0" cellpadding="0" cellspacing="0" style="margin-top: 3px">
									<tr>
										<td>
											<h:commandButton value="#{msgs.label_save} &nbsp; #{msgs.fa_floppy_o}" action="#{transactionsStepsCycleManagement.save()}" id="saveBtn" styleClass="btn_normal_icon" />
										</td>
									</tr>
								</table>
							</h:panelGroup>
						</h:panelGroup>
					</td>
				</tr>
			</table>
		</ui:decorate>
	</h:form>
</h:body>
</html>